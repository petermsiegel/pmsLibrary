<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>âˆ†F_Help</title>
	<style>
		/* Basic styles for readability */
		body {
			font-family: sans-serif;
			max-width: 800px;
			margin: 2em auto;
			padding: 0 1em;
			line-height: 1.6;
		}
		img { max-width: 100%; height: auto; }
		pre { background-color: #f4f4f4; padding: 1em; overflow-x: auto; }
		code { font-family: monospace; }
	</style>
</head>
<body>
	<!-- Preview in sep files: cmd-shift-V,
Preview side-by-side: cmd-K, V,
md->HTML: opt-shift-M
-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.8.1/github-markdown.css">
<!-- Style stuff related to APL -->
<style> 
  p {
    font-family: Georgia;
    font-size: 110%;
    line-height: 1.2;
  }
  li {
  }
  /* Inline code */
  code { 
    font-size: 110%;
    background-color: #ddfafaff;
    padding: 2px 4px;
    border-radius: 3px;
    font-family: "APL386 Unicode", APL385, "APL385 Unicode", 
       "Courier New", Courier, Lucida Console", "Consolas", monospace;
  }
  /* Code blocks */ 
  pre { 
    background-color: #ddfafaff;  
    color: #0a0a0aff;
    font-size: 110%;
    line-height: 105%;
    padding: 15px;
    border-radius: 5px;
    overflow-x: auto; 
    font-family: "APL386 Unicode", APL386, "APL385 Unicode", APL385, "Courier New", Courier,
    "Lucida Console", "Consolas", monospace;
  }
  table {
    background-color: #eae9ebaa;
    line-height: 1.1;
    font-family: "APL386 Unicode", APL386, "APL385 Unicode", APL385 "Courier New", Courier,
    "Lucida Console", "Consolas", monospace;
  }
  /* Table header */
  th {  
    line-height: 1.1;
    font-weight: 900;
    background-color: #740000ff;
    color: #f3efef;
  }
  blockquote {
    font-size: 110%;
    background-color: #f4f5f5ff;  
  }
</style>
<h2>âˆ†F â€” Formatted String Literals</h2>
<h3>âˆ†F In BriefÂ¹</h3>
<blockquote>
<p><strong>âˆ†F is a function for Dyalog APL that interprets <i>â€‰f-string</i>Â² string literals, a concise, yet powerful way to display multiline Unicode text and complex expressions in an APL-friendly style</strong>.</p>
</blockquote>
<p><strong>âˆ†F f-strings</strong> can concisely include:</p>
<ul>
<li>
<p><strong>Text fields</strong>, expressions that can generate multiline Unicode text, using the sequence <code>`â‹„</code> (<em><em>backtick + statement separator</em></em>) to generate a newline (<small><strong>â•UCS 13</strong></small>);</p>
</li>
<li>
<p><strong>Code fields</strong>, allowing users to display APL objects in the user environment or passed as <strong>âˆ†F</strong> arguments, as well as arbitrary APL expressions and full multi-statementÂ³ dfn logic; each <strong>Code field</strong> must return a value, simple or otherwise, which will be aligned and catenated with other fields and returned from <strong>âˆ†F</strong>;</p>
</li>
<li>
<p><strong>Code fields</strong> also provide a number of concise, convenient extensions, such as:</p>
<ul>
<li>
<p><strong>Quoted strings</strong> in <strong>Code fields</strong>, with several quote styles:</p>
<ul>
<li><strong>double-quotes</strong> <code>{&quot;like this&quot;}</code> or this <code> {&quot;on`â‹„three`â‹„lines&quot;}</code>,</li>
<li><strong>single-quotes</strong>, <em>distractingly</em> <code>{''shown ''''right'''' here''}'</code>,<br>
or even</li>
<li><strong>double angle quotation marks</strong>,âµ i.e. <em>guillemets</em>,<br>
<code>{Â«with internal &quot;quotes&quot; and ''more''.Â»}</code>;</li>
</ul>
</li>
<li>
<p>Simple shortcutsâ¶ for</p>
<ul>
<li>formatting numeric arrays, <strong>$</strong> (short for <strong>â•FMT</strong>): <code>{&quot;F7.5&quot; $ ?0 0}</code>,</li>
<li>putting a box around a specific expression, <strong>`B</strong>: <code>{`B â³2 2}</code>,</li>
<li>placing the output of one expression <em>above</em> another, <strong>%</strong>: <code>{&quot;Pi&quot;% â—‹1}</code>,</li>
<li>formatting date and time expressions from APL timestamps (<strong>â•TS</strong>) using <strong>`T</strong> ( short for an expression with <strong>1200âŒ¶</strong> and <strong>â•DT</strong>):<code>{&quot;hh:mm:ss&quot; `T â•TS}</code>:,</li>
</ul>
<p>and more; as well as concisely inserting data from</p>
<ul>
<li>user objects or arbitrary code: <code>{tempC}</code> or <code>{32+tempCÃ—9Ã·5}</code>,
and/or</li>
<li>arguments to <strong>âˆ†F</strong> that follow the format string: <code>{32+`âµ1Ã—9Ã·5}</code>, where <code>`âµ1</code> is a shortcut for <code>(âµâŠƒâ¨1+â•IO)</code>;</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Space fields</strong>, providing a simple mechanism both for separating adjacent <strong>Text fields</strong> and inserting (rectangular) blocks of any number of spaces between any two fields, where needed;</p>
</li>
<li>
<p>Multiline (matrix) output built up field-by-field, left-to-right, from values and expressions in the calling environment or arguments to <strong>âˆ†F</strong>;</p>
<ul>
<li>After all fields are generated, they are concatenated (after appropriate vertical conformation) to form a single <strong><em>returned</em></strong> character matrix, as in this simple example:</li>
</ul>
<pre><code>  tempCâ† âª35 85
  â´â•â† âˆ†F 'The temperature is {tempC}{2 2â´&quot;âˆ˜C&quot;} or {32+tempCÃ—9Ã·5}{2 2â´&quot;âˆ˜F&quot;}'
The temperature is 35âˆ˜C or  95âˆ˜F.
                   85âˆ˜C    185âˆ˜F
2 32
</code></pre>
</li>
</ul>
<p><strong>âˆ†F</strong> is designed for ease of use, <em>ad hoc</em> debugging, and informal user interaction; APLâ€™s native tools and Dyalogâ€™s enhancements are always the bestâ´ way to build and display complex objects, unless <strong>âˆ†F</strong>â€™s specific functionality is of use.</p>
<div style="margin-left: 20px;">
<table>
<thead>
<tr>
<th style="text-align:left">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Â¹ Throughout this documentation, notably in the many examples, an index origin of zero (<strong>â•IOâ†0</strong>) is assumed. Users may utilize <em>any</em> index origin in the <strong>f-string Code fields</strong> they define, as long as itâ€™s <strong>1</strong> or <strong>0</strong>. <strong>Code fields</strong> inherit the index origin of the environment (i.e. namespace) from which <strong>âˆ†F</strong> is called.</td>
</tr>
<tr>
<td style="text-align:left">Â² <strong>âˆ†F</strong> is inspired by Python <em><a href="https://docs.python.org/3/tutorial/inputoutput.html#formatted-string-literals">f-strings</a></em>, short for â€œ<strong>formatted string literals</strong>â€, but designed for APLâ€™s multi-dimensional worldview. <strong>âˆ†F</strong> f-strings and Pythonâ€™s are not compatible.</td>
</tr>
<tr>
<td style="text-align:left">Â³ <strong>âˆ†F Code fields</strong> <em>as input</em> are limited to a single, possibly very long, line.</td>
</tr>
<tr>
<td style="text-align:left">â´ As a prototype, <strong>âˆ†F</strong> is currently relatively slow, in that it analyzes the <strong>f-string</strong> using an APL recursive scan.</td>
</tr>
<tr>
<td style="text-align:left">âµ Double angle quotation marks <strong>Â«Â»</strong> (guillemets) are Unicode chars <small><strong>â•UCS 171 187</strong></small>. When including literal guillemets in guillemet-bracketed quotations (<em>but why?</em>), opening guillemets <strong>Â«</strong> are <em>not</em> doubled, but <em>two</em> closing guillemets are needed for each literal <strong>Â»</strong> required.</td>
</tr>
<tr>
<td style="text-align:left">â¶ Details on all the shortcuts are provided later in this document. See <strong><em>Code Field Shortcuts.</em></strong></td>
</tr>
</tbody>
</table>
</div>
<hr>
<h2>âˆ†F EXAMPLES</h2>
<p>Before providing information on âˆ†F syntax and other details, <em>letâ€™s start with some examples</em>â€¦</p>
<pre><code>â  Set some values we'll need for our examples...
   â•RL â•IO â•MLâ†2342342 0 1         â â•RL: Ensure our random #s aren't random!
</code></pre>
<pre><code>â  Code fields with plain variables
   nameâ† 'Fred' â‹„ ageâ† 43
   âˆ†F 'The patient''s name is {name}. {name} is {age} years old.'
The patient's name is Fred. Fred is 43 years old.
</code></pre>
<pre><code>â  Arbitrary code expressions
   namesâ† 'Mary' 'Jack' 'Tony' â‹„ prizeâ† 1000
   âˆ†F 'Customer {namesâŠƒâ¨ ?â‰¢names} wins Â£{?prize}!'
Customer Jack wins Â£80!
   âˆ†F 'Customer {namesâŠƒâ¨ ?â‰¢names} wins Â£{?prize}!'
Customer Jack wins Â£230!
</code></pre>
<blockquote>
<p>Isnâ€™t Jack lucky, winning twice in a row!</p>
</blockquote>
<h3>Now, letâ€™s add in some Space fields</h3>
<pre><code>â  Some multi-line Text fields separated by non-null Space fields
â  âˆ˜ The backtick is our &quot;escape&quot; character.
â  âˆ˜ Here each  `â‹„ displays a newline character in the left-most &quot;field.&quot;
â  âˆ˜ { } is a Space Field indicating one space, given one space
â    within the braces.
â  A Space field is useful here because each multi-line field is built
â  in its own rectangular space.
   âˆ†F 'This`â‹„is`â‹„an`â‹„example{ }Of`â‹„multi-line{ }Text`â‹„Fields'
This    Of         Text
is      multi-line Fields
an
example
</code></pre>
<pre><code>â  Two adjacent Text fields can be separated by a Null Space field {},
â  for example when at least one field contains multiline input that you
â  want formatted separately (keeping each field in is own rectangular space):
   âˆ†F 'Cat`â‹„Elephant `â‹„Mouse{}Felix`â‹„Dumbo`â‹„Mickey'
Cat      Felix
Elephant Dumbo
Mouse    Mickey
</code></pre>
<p>In the above example, we added an extra space after the longest
animal nameâ€¦</p>
<h3>But wait! Thereâ€™s an easier way!</h3>
<p>Here, you surely want the lefthand field to be guaranteed to have a space
after <em>each</em> word without fiddling, so a <strong>Space field</strong> with at least
one space would be way more convenient:</p>
<pre><code>â  Here's the better way to ensure there's a space after the
â  widest element in a field.
   âˆ†F 'Cat`â‹„Elephant`â‹„Mouse{ }Felix`â‹„Dumbo`â‹„Mickey'
Cat      Felix
Elephant Dumbo
Mouse    Mickey

â  And this is the same example, but with two Code fields separated
â  by a Text field with a single space.
   âˆ†F '{â†‘&quot;Cat&quot; &quot;Elephant&quot; &quot;Mouse&quot;} {â†‘&quot;Felix&quot; &quot;Dumbo&quot; &quot;Mickey&quot;}'
Cat      Felix
Elephant Dumbo
Mouse    Mickey
</code></pre>
<pre><code>â  A similar example with double-quote-delimited strings in Code fields with
â  the newline sequence (`â‹„):
   âˆ†F '{&quot;This`â‹„is`â‹„an`â‹„example&quot;} {&quot;Of`â‹„Multi-line&quot;} {&quot;Strings`â‹„in`â‹„Code`â‹„Fields&quot;}'
This    Of          Strings
is      Multi-line  in
an                  Code
example             Fields
</code></pre>
<pre><code>â  Here is some multiline data we'll add to our Code fields
   fnâ†   'John'           'Mary'         'Ted'
   lnâ†   'Smith'          'Jones'        'Templeton'
   addrâ† '24 Mulberry Ln' '22 Smith St'  '12 High St'
   âˆ†F '{â†‘fn} {â†‘ln} {â†‘addr}'
John Smith     24 Mulberry Ln
Mary Jones     22 Smith St
Ted  Templeton 12 High St
</code></pre>
<pre><code>â  A slightly more interesting code expression, using the shortcut $ (â•FMT)
â   to round the calculated Fahrenheit numbers to the nearest tenth:
   Câ† 11 30 60
   âˆ†F'The temperature is {&quot;I2&quot; $ C}Â°C or {&quot;F5.1&quot; $ 32+9Ã—CÃ·5}Â°F'
The temperature is 11Â°C or  51.8Â°F
30       86.0
60      140.0
</code></pre>
<pre><code>â  Here we place boxes around key Code fields using the shortcut `B (box).
   âˆ†F'`â‹„The temperature is {`B &quot;I2&quot; $ C}`â‹„Â°C or {`B &quot;F5.1&quot; $ 32+9Ã—CÃ·5}`â‹„Â°F'
                   â”Œâ”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”
The temperature is â”‚11â”‚Â°C or â”‚ 51.8â”‚Â°F
                   â”‚30â”‚      â”‚ 86.0â”‚
                   â”‚60â”‚      â”‚140.0â”‚
                   â””â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3>What if you want to place a box around every <strong>Code</strong>, <strong>Text</strong>, <strong><em>and</em></strong> <strong>Space field</strong>?</h3>
<p>Just use <strong>Box mode</strong>: <code>0 0 1 âˆ†F...</code></p>
<pre><code>â  While we can't place boxes around text (or space) fields using `B,
â  we can place a box around EACH of our fields by setting the
â  third âˆ†F option (âº[2]):
   0 0 1 âˆ†F'`â‹„The temperature is {&quot;I2&quot; $ C}`â‹„Â°C or {&quot;F5.1&quot; $ 32+9Ã—CÃ·5}`â‹„Â°F'
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”
â”‚                   â”‚11â”‚      â”‚ 51.8â”‚  â”‚
â”‚The temperature is â”‚30â”‚Â°C or â”‚ 86.0â”‚Â°Fâ”‚
â”‚                   â”‚60â”‚      â”‚140.0â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”˜
</code></pre>
<p>We said you could place a box around every field.
<strong>Null Space fields</strong> <code>{}</code>, i.e. 0-width <strong>Space fields</strong>, are an exception: after doing their work of separating adjacent <strong>Text fields</strong>, <strong>Null Space fields</strong> are ignored and wonâ€™t be placed in boxes.
Try this expression on your own:</p>
<pre><code>0 0 1 âˆ†F 'abc{}def{}{}ghi{&quot;&quot;}jkl{ }mno'
</code></pre>
<p>In contrast, <strong>Code fields</strong> that return null values (like <code>{&quot;&quot;}</code> above) <em>will</em> be displayed!</p>
<pre><code>â  Referencing an external variable (C) and function (C2F)
   Câ† 11 30 60
   C2Fâ† 32+9Ã—Ã·âˆ˜5
   âˆ†F'The temperature is {&quot;I2&quot; $ C}Â°C or {&quot;F5.1&quot; $ C2F C}Â°F'
The temperature is 11Â°C or 51.8Â°F
                   30      86.0
                   60     140.0
</code></pre>
<h3>Referencing âˆ†F arguments after the f-string: Omega shortcut expressions like <code>`âµ1</code></h3>
<p>The expression <code>`âµ1</code> is equivalent to <code>(âµâŠƒâ¨ 1+â•IO)</code>, selecting the first argument after the f-string. Similarly, <code>`âµ99</code> would select <code>(âµâŠƒâ¨99+â•IO)</code>.</p>
<pre><code>â  We will use `âµ1 here, both with shortcuts and an externally defined
â  function C2F.
â  Later, we'll discuss bare `âµ (i.e. w/o an adjacent non-negative integer).
   âˆ†F'The temperature is {&quot;I2&quot; $ `âµ1}Â°C or {&quot;F5.1&quot; $ C2F `âµ1}Â°F' (11 15 20)
The temperature is 11Â°C or 51.8Â°F
                   15      59.0
                   20      68.0
</code></pre>
<h3>Letâ€™s add commas to some very large numbers using the <code>$</code> (<strong>â•FMT</strong>) shortcut</h3>
<pre><code>â  The temperature of the sun at its core in degrees C.
   sun_coreâ† 15E6            â 15000000 is a bit hard to parse!
â  Use Dyalog's built-in formatting specifier &quot;C&quot; with shortcut $ (â•FMT)
â  to add appropriate commas to the temperatures!
   âˆ†F'The sun''s core is at {&quot;CI10&quot;$sun_ core}Â°C or {&quot;CI10&quot;$C2F sun_ core}Â°F'
The sun's core is at 15,000,000Â°C or 27,000,032Â°F
</code></pre>
<h3>An easier way to add commas to large numbers or numeric strings: the <code>`C</code> shortcut</h3>
<p>The <code>`C</code> shortcut adds commas every 3 digits (from the right) to one or more numbers (or numeric strings). It has an advantage over the <code>$</code> (<strong>â•FMT</strong>) specifier: it doesnâ€™t require you to guesstimate field widths.</p>
<pre><code>â  Let's use the `C shortcut to add the commas to the temperatures!
â  Typically, each number presented to `C is an integer, but if a real number
â  is presented, only the integer part has commas added.
   âˆ†F'The sun''s core is at {`C sun_ core}Â°C or {`C C2F sun_ core}Â°F'
The sun's core is at 15,000,000Â°C or 27,000,032Â°F
</code></pre>
<h3>Self-documenting <strong>Code fields</strong> (SDCFs) are a useful debugging tool.</h3>
<p>Whatâ€™s an SDCF? An SDCFÂ¹ allows whatever source code is in a <strong>Code Field</strong> to be automatically displayed literally along with the result of evaluating that code.</p>
<div style="margin-left: 75px;">
<table>
<thead>
<tr>
<th style="text-align:left">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Â¹ SDCFs come from Pythonâ€™s <strong><a href="https://docs.python.org/3/whatsnew/3.8.html#f-strings-support-for-self-documenting-expressions-and-debugging">self-documenting expressions</a></strong> in <em>f-strings</em>. SDCFs are used <strong><em>only</em></strong> in <strong>Code fields</strong> (<em>duh</em>).</td>
</tr>
</tbody>
</table>
</div>
<p>You may automatically place the source for a <strong>Code field</strong>â€¦</p>
<ul>
<li>to the left of the result of evaluating that code; or,</li>
<li>centered above the result of evaluating that code.</li>
</ul>
<p>All you have to do is place</p>
<ul>
<li>a right arrow, <strong>â†’</strong>, (for a <strong>horizontal</strong> SDCF), or</li>
<li>a down arrow, <strong>â†“</strong>, (for a <strong>vertical</strong> SDCF)</li>
</ul>
<p>as the last <strong><em>non-space</em></strong> in the <strong>Code field</strong>, before the <em>final</em> right brace.</p>
<pre><code>â  Horizontal SDCF example
   nameâ†'John Smith' â‹„ ageâ† 34
   âˆ†F 'Current employee: {nameâ†’}, {ageâ†’}.'
Current employee: nameâ†’John Smith, ageâ†’34.
</code></pre>
<p>As a useful formatting feature, whatever spaces are just before or after the symbol <strong>â†’</strong> or <strong>â†“</strong> are preserved <strong><em>verbatim</em></strong> in the output.</p>
<pre><code>â  Here's an example:
â  See how the spaces adjacent to the symbol &quot;â†’&quot; are mirrored in the output!
   nameâ†'John Smith' â‹„ ageâ† 34
   âˆ†F 'Current employee: {name â†’ }, {ageâ†’   }.'
Current employee: name â†’ John Smith, ageâ†’   34.
</code></pre>
<pre><code>â  Here's an example of a vertical SDCF:
   nameâ†'John Smith' â‹„ ageâ† 34
   âˆ†F 'Current employee: {nameâ†“} {ageâ†“}.'
Current employee:   nameâ†“    ageâ†“.
                  John Smith  34
</code></pre>
<pre><code>â  Here's the same result, but with a box around each field, to make it
â  easy to see.
â     âµ[2]=1: Box all fields (assume â•IO=0).
   0 0 1 âˆ†F 'Current employee: {nameâ†“} {ageâ†“}.'
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”¬â”€â”€â”€â”€â”¬â”€â”
â”‚Current employee: â”‚  nameâ†“   â”‚ â”‚ageâ†“â”‚.â”‚
â”‚                  â”‚John Smithâ”‚ â”‚ 34 â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”´â”€â”€â”€â”€â”´â”€â”˜
</code></pre>
<h3>A cut above the rest. Using % (<em>above</em>).</h3>
<pre><code>â  Let's use the shortcut % to display one expression centered above another;
â  It's called &quot;above&quot; and can also be expressed as  `A.
â  Remember, `âµ1 refers to the first argument after the f-string itself;
â  And `âµ2 refers to the second.
   âˆ†F '{&quot;Employee&quot; % âª`âµ1} {&quot;Age&quot; % âª`âµ2}' ('John Smith' 'Mary Jones')(29 23)
 Employee   Age
John Smith  29
Mary Jones  23
</code></pre>
<div style="margin-left: 20px;">
<table>
<thead>
<tr>
<th style="text-align:left">Side Note</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>`âµ0</code> refers to the f-string itself. Try this yourself: Â Â <code>âˆ†F 'Our string {`âµ0â†“} is {â‰¢`âµ0} characters'</code></td>
</tr>
</tbody>
</table>
</div>
<h3>The <em>next</em> best thing: the use of <em>bare</em> <code>`âµ</code> in <strong>Code field</strong> expressions</h3>
<p>The expression <code>`âµ</code> selects the <em>next</em> element of the right argument <code>âµ</code>, defaulting to <code>`âµ1</code> when first encountered, i.e. if there are <strong><em>no</em></strong> <code>`âµ</code> elements to the <strong><em>left</em></strong> in the f-string. If there is any such expression (e.g. <code>`âµ5</code>), then <code>`âµ</code> points to the element after that one (here, <code>`âµ6</code>). If the item to the left is <code>`âµ</code>, then we simply increment the index by <code>1</code> from that one. <strong>Letâ€™s try an example.</strong></p>
<pre><code>â  Let's display arbitrary 2-dimensional expressions, one above the other.
â  `âµ refers to the next argument in sequence, left to right, starting with `âµ1, the first.
â  â˜ From left to right `âµ is `âµ1, `âµ2, and `âµ3. Easy peasy.
   âˆ†F'{(â³2â´`âµ) % (â³2â´`âµ) % (â³2â´`âµ)}' 1 2 3
    0 0
  0 0 0 1
  1 0 1 1
0 0 0 1 0 2
1 0 1 1 1 2
2 0 2 1 2 2
</code></pre>
<p>Letâ€™s demonstrate the equivalence of the <em>implicit</em> and <em>explicit</em> <strong>Omega expressions</strong> here!</p>
<pre><code>    aâ† âˆ†F '{(â³2â´`âµ) % (â³2â´`âµ) % (â³2â´`âµ)}' 1 2 3     â Implicit Omega expressions
    bâ† âˆ†F '{(â³2â´`âµ1) % (â³2â´`âµ2) % (â³2â´`âµ3)}' 1 2 3  â Explicit Omega expressions
    a â‰¡ b                                           â Are they the same?
1                                                   â Yes!
</code></pre>
<h3>And Shortcuts can often make sense with expressions, not just entire Code fields</h3>
<pre><code>â  Here, we display one boxed value above the other.
   âˆ†F '{(`B â³`âµ1) % `B â³`âµ2}' (2 2)(3 3)
  â”Œâ”€â”€â”€â”¬â”€â”€â”€â”
  â”‚0 0â”‚0 1â”‚
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¤
  â”‚1 0â”‚1 1â”‚
  â””â”€â”€â”€â”´â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
â”‚0 0â”‚0 1â”‚0 2â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚1 0â”‚1 1â”‚1 2â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚2 0â”‚2 1â”‚2 2â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
</code></pre>
<h3>Formatting Dates and Times Using â•TS-format Timestamps: the `T shortcutâ€¦</h3>
<p>Hereâ€™s a simple Date-Time shortcut <code>`T</code> built from <strong>1200âŒ¶</strong> and <strong>â•DT</strong>. It takes one or more Dyalog <code>â•TS</code>-format timestamps as the right argument and a date-time specification as the (optional) left argument. Trailing elements of a timestamp may be omitted, if they are not referenced in the specification string.</p>
<pre><code>â  âˆ˜ Let's look at the use of the `T (Date-Time) shortcut to show the
â    current time (now).
â  âˆ˜ The right argument is always a â•TS or any non-empty prefix thereof.
   âˆ†F'It is now {&quot;t:mm pp&quot; `T â•TS}.'
It is now 8:08 am. â NB: this will be the current actual time, of course.
</code></pre>
<pre><code>â  Here's a more powerful example (the power is in 1200âŒ¶ and â•DT).
â  (Right arg &quot;hardwired&quot; into F-string)
   âˆ†F'{ &quot;D MMM YYYY ''was a'' Dddd.&quot;`T 2025 01 01}'
1 JAN 2025 was a Wednesday.
</code></pre>
<h3>Dates and Times: <code>`D</code> is an alias for <code>`T</code></h3>
<pre><code>â  If it bothers you to use `T for a date-only expression,
â  you can use `D, which means exactly the same thing.
   âˆ†F'{ &quot;D MMM YYYY ''was a'' Dddd.&quot; `D 2025 01 02}'
2 JAN 2025 was a Thursday.
</code></pre>
<pre><code>â  Here, we'll pass the time stamp via a single omega
â  expression: `âµ1.
   âˆ†F'{ &quot;D Mmm YYYY ''was a'' Dddd.&quot; `T `âµ1}' (2025 1 21)
21 Jan 2025 was a Tuesday.
</code></pre>
<pre><code>â  âˆ˜ And here, we pass the time stamp via a sequence of omega
â    expressions: `âµ `âµ `âµ.
â  âˆ˜ Here, this is equivalent to the slightly verbose
â    expression: `âµ1 `âµ2 `âµ3
   âˆ†F'{ &quot;D Mmm YYYY ''was a'' Dddd.&quot; `T `âµ `âµ `âµ}' 2025 1 21
21 Jan 2025 was a Tuesday.
</code></pre>
<h3>Precomputed F-strings: Performance of âˆ†F (or 0 âˆ†F) vs 1 âˆ†F â€¦</h3>
<p>Letâ€™s explore getting the best performance for a heavily
used âˆ†F string. Using the DFN option <code>(âº[0]=1)</code>, we can generate a
dfn that will display the formatted output, without having to reanalyze
the f-string each time.
We will compare the performance of an âˆ†F-string evaluated on the fly</p>
<pre><code>    mxâ† âˆ†F '...'           â the same as   mxâ† 0 âˆ†F '...'
</code></pre>
<p>vs one precomputed and returned as a dfn, using</p>
<pre><code>   dfnâ†  1 âˆ†F '...'
</code></pre>
<h3>First, letâ€™s get <code>cmpx</code>, so we can compare the performanceâ€¦</h3>
<pre><code>   'cmpx' â•CY 'dfns'

â  Now, let's proceed...
   Câ† 11 30 60

â  Here's our âˆ†F String t
   tâ†'The temperature is {&quot;I2&quot; $ C}Â°C or {&quot;F5.1&quot; $ Fâ† 32+9Ã—CÃ·5}Â°F'

â  Let's precompute a dfn T, given âˆ†F String t.
â  It has everything needed to generate the output,
â  except the external variables or additional arguments needed.
   Tâ†1 âˆ†F t

â  Compare the performance of the two formats...
â  The precomputed version is about 17 times faster, in this run.
   cmpx 'âˆ†F t' 'T â¬'
âˆ†F t â†’ 1.7EÂ¯4 |  0% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
T â¬  â†’ 1.0EÂ¯5 |-94% â•â•
</code></pre>
<h3>Before we get to syntax and other informationâ€¦</h3>
<pre><code>â  We'll leave you with this variant, where we pass the centigrade value,
â  not as a variable, but as a subsequent argument to âˆ†F.
   tâ†'The temperature is {&quot;I2&quot; $ `âµ1}Â°C or {&quot;F5.1&quot; $ Fâ† 32+9Ã—`âµ1Ã·5}Â°F'
   Tâ† 1 âˆ†F t
   âˆ†F t 35
The temperature is 35Â°C or 95.0Â°F
   T 35
The temperature is 35Â°C or 95.0Â°F
   cmpx 'âˆ†F t 35' 'T 35'
âˆ†F t 35 â†’ 1.7EÂ¯4 |   0% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
T 35    â†’ 8.9EÂ¯6 | -95% â•â•
</code></pre>
<h2>âˆ†F Syntax and Other Information</h2>
<h3>Call Syntax Overview</h3>
<table>
<thead>
<tr>
<th style="text-align:left">Call Syntax <div style="width:200px"></div></th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>âˆ†F</strong> <em>f-string</em></td>
<td style="text-align:left">Display an <em>f-string</em>; use the default options. The string may reference objects in the environment or in the string itself. Returns a character matrix.</td>
</tr>
<tr>
<td style="text-align:left"><strong>âˆ†F</strong> <em>f-string</em> <em>arg1</em> [<em>arg2</em> â€¦]</td>
<td style="text-align:left">Display an <em>f-string</em>; use the default options. Args presented may be referred to in the f-string. Returns a character matrix.</td>
</tr>
<tr>
<td style="text-align:left"><em>options</em> <strong>âˆ†F</strong> <em>f-string</em> [<em>args</em>]</td>
<td style="text-align:left">Display an <em>f-string</em>; control result with <em>options</em> (see below).</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">If the initial option (DFN) is <strong>0</strong> or omitted, returns a character matrix.</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">If the initial option (DFN) is <strong>1</strong>, returns a dfn generating such a matrix.</td>
</tr>
<tr>
<td style="text-align:left">â€˜helpâ€™ <strong>âˆ†F</strong> â€˜â€™</td>
<td style="text-align:left">Display help info and examples for <strong>âˆ†F</strong>. The <em>f-string</em> is not examined.</td>
</tr>
<tr>
<td style="text-align:left"><strong>âˆ†F</strong>â¨â€™helpâ€™</td>
<td style="text-align:left">A shortcut for displaying help info and examples (above).</td>
</tr>
</tbody>
</table>
<h3>Call Syntax Details</h3>
<table>
<thead>
<tr>
<th style="text-align:left">Element <div style="width:200px"></div></th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">f-string</td>
<td style="text-align:left">a format string, a single character vector.</td>
</tr>
<tr>
<td style="text-align:left">args</td>
<td style="text-align:left">elements of âµ after the f-string, each of which can be accessed in the f-string via a <strong>`âµ</strong> shortcut (or ordinary <strong>âµ</strong> expression)</td>
</tr>
<tr>
<td style="text-align:left">options</td>
<td style="text-align:left">[ optionsâ† [ 0 [ 0 [ 0 [ 0 ] ] ] ] | â€˜helpâ€™ ]</td>
</tr>
<tr>
<td style="text-align:left">Â Â options[0] (<strong><em>DFN</em></strong>)</td>
<td style="text-align:left">If <code>1</code>, <strong>âˆ†F</strong> returns a dfn, which (upon execution) produces the same output as the default mode. Default: <strong>âˆ†F</strong> returns a char. matrix.</td>
</tr>
<tr>
<td style="text-align:left">Â Â options[1] (<strong><em>DBG</em></strong>)</td>
<td style="text-align:left">If <code>1</code>, prints out (via <code>â•â†</code>) the dfn-version of the f-string.</td>
</tr>
<tr>
<td style="text-align:left">Â Â options[2] (<strong><em>BOX</em></strong>)</td>
<td style="text-align:left">If <code>1</code>, each field (except a Null Text field) is boxed separately. If <code>0</code>, you may box any <strong>Code fields</strong> you want using the <em>box</em> <code>`B</code> routine. <strong>BOX</strong> mode can be used both with <strong>DFN</strong> and default output mode.</td>
</tr>
<tr>
<td style="text-align:left">Â Â options[3] (<strong><em>INLINE</em></strong>)</td>
<td style="text-align:left">If <code>1</code>, a copy of each needed internal support function is included in the result. If <code>0</code>, calls are made to the library created when âˆ†F was loaded. Setting <strong><em>INLINE</em></strong> to <code>1</code> is only useful if the <strong>DFN</strong> option is set. This option is experimental and may simply disappear one day.</td>
</tr>
<tr>
<td style="text-align:left">Â Â â€˜helpâ€™</td>
<td style="text-align:left">If <code>'help'</code> is specified, this amazing documentation is displayed.</td>
</tr>
<tr>
<td style="text-align:left">result</td>
<td style="text-align:left">If <code>0=âŠƒoptions</code>, the result is always a character matrix. If <code>1=âŠƒoptions</code>, the result is a dfn that, <em>when executed</em>, generates that same character matrix.</td>
</tr>
</tbody>
</table>
<h3>Options (âº)</h3>
<ul>
<li>
<p>If the left argument <code>âº</code> is omitted, the options are <code>4â´0</code>.</p>
</li>
<li>
<p>If the left argument <code>âº</code> is a simple boolean vector or scalar, or an empty numeric vector <code>â¬</code>, the options are <code>4â†‘âº</code>; subsequent elements are ignored;</p>
</li>
<li>
<p>If the left argument <code>âº</code> starts with <code>'help'</code> (case ignored), this help information is displayed.</p>
</li>
<li>
<p>Otherwise, an error is signaled.</p>
</li>
</ul>
<h3>Return Value</h3>
<ul>
<li>
<p>Unless the <strong>DFN</strong> option is selected, <strong>âˆ†F</strong> always returns a character matrix of at least one row and zero columns, <code>1 0â´0</code>, on success. If the â€˜helpâ€™ option is specified, <strong>âˆ†F</strong> returns <code>1 0â´0</code>.</p>
</li>
<li>
<p>If the <strong>DFN</strong> option is selected, <strong>âˆ†F</strong> always returns a standard Dyalog dfn on success.</p>
</li>
<li>
<p>On failure of any sort, an informative APL error is signaled.</p>
</li>
</ul>
<h3>âˆ†F f-string building blocks</h3>
<p>The first element in the right arg to âˆ†F is a character vector, an <strong>f-string</strong>,
which contains 3 types of fields: <strong>Text fields</strong>, <strong>Code fields</strong>, and <strong>Space fields</strong>.</p>
<ul>
<li>
<p><strong>Text fields</strong> consist of simple text, which may include any Unicode characters desired, including newlines. Newlines (actually, carriage returns, <code>â•UCS 13</code>) are normally entered via the sequence <code>`â‹„</code>. Additionally, literal curly braces can be added via <code>`{</code> and <code>`}</code>, so there is no confusion with the simple curly braces used to begin and end <strong>Code fields</strong> and <strong>Space Fields</strong>. Finally, a simple backtick escape can be entered into a <strong>Text field</strong> by simply entering two such characters <code>``</code>.</p>
</li>
<li>
<p><strong>Code fields</strong> are run-time evaluated expressions enclosed within
simple, unescaped curly braces <code>{}</code>, i.e. those not preceded by a back-tick (see the previous paragraph). <strong>Code fields</strong> are essentially a Dyalog dfn with some extras.</p>
</li>
<li>
<p><strong>Space fields</strong> are essentially a <em>degenerate</em> form of <strong>Code fields</strong>, consisting of a single pair of simple curly braces <code>{}</code> with zero or more spaces in between. A <strong>Space Field</strong> with zero spaces is a <strong>Null Space Field</strong>; while it may separate any other fields, its practical use is separating two adjacent <strong>Text Fields</strong>.</p>
</li>
</ul>
<p>The building blocks of an <strong>f-string</strong> are these defined â€œfields,â€ catenated left to right,
each of which will display as a logically separate 2-D output space. While <strong>Code fields</strong> can return objects of any number of dimensions mapped onto 2-D by APL rules, <strong>Text fields</strong> and <strong>Space fields</strong> are always simple rectangles (minimally 1 row and zero columns). Between fields, <strong>âˆ†F</strong> adds no automatic spaces. That spacing is under user control.</p>
<h3>Escape Sequences for Text Fields and Quoted Strings</h3>
<p>âˆ†F-string <strong>Text fields</strong> and <strong>Quoted strings</strong> in <strong>Code fields</strong> may include
a small number of escape sequences, beginning with the backtick <code>`</code>.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Escape sequenceÂ Â </th>
<th style="text-align:left">Literal OutputÂ Â </th>
<th style="text-align:left">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">`â‹„</td>
<td style="text-align:left">(newline)</td>
<td style="text-align:left">(â•UCS 13)</td>
</tr>
<tr>
<td style="text-align:center">``</td>
<td style="text-align:left">`</td>
<td style="text-align:left">backtick</td>
</tr>
<tr>
<td style="text-align:center">`{</td>
<td style="text-align:left">{</td>
<td style="text-align:left">left brace</td>
</tr>
<tr>
<td style="text-align:center">`}</td>
<td style="text-align:left">}</td>
<td style="text-align:left">right brace</td>
</tr>
</tbody>
</table>
<p>Other instances of the backtick character in <strong>Text fields</strong> or <strong>Quoted strings</strong> in <strong>Code fields</strong> will be treated literally, <em>i.e.</em>
as an ordinary backtick <code>`</code>.</p>
<h3>Code Field Shortcuts</h3>
<p>âˆ†F-string <strong>Code fields</strong> may contain various shortcuts, intended to be concise and expressive tools for common tasks. <strong>Shortcuts</strong> are valid <strong>only</strong> outside <strong>Quoted strings</strong>. They include:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Shortcut <div style="width:100px"></div></th>
<th style="text-align:left">Name <div style="width:150px"></div></th>
<th style="text-align:left">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">$, `F</td>
<td style="text-align:left">â•FMT</td>
<td style="text-align:left"><code>[âº] â•FMT âµ</code></td>
</tr>
<tr>
<td style="text-align:left">%, `A</td>
<td style="text-align:left">above</td>
<td style="text-align:left">Places object <code>âº</code> above object <code>âµ</code>. Default <code>âºâ†''</code>.</td>
</tr>
<tr>
<td style="text-align:left">`B</td>
<td style="text-align:left">box</td>
<td style="text-align:left">Places <code>âµ</code> in a box. <code>âµ</code> is any object.</td>
</tr>
<tr>
<td style="text-align:left">`C</td>
<td style="text-align:left">commas</td>
<td style="text-align:left">Adds commas to <code>âµ</code> after every 3rd digit. <code>âµ</code> is a vector of num strings or numbers.</td>
</tr>
<tr>
<td style="text-align:left">`T, `D</td>
<td style="text-align:left">Date-TimeÂ¹</td>
<td style="text-align:left">Displays <code>âµ</code> according to <code>âº</code>. <code>âµ</code> is one or more APL timestamps <code>â•TS</code>. <code>âº</code> is a date-time template. If omitted, <code>âºâ† 'YYYY-MM-DD hh:mm:ss'</code>.</td>
</tr>
<tr>
<td style="text-align:left">`âµğ’‹, â¹ğ’‹</td>
<td style="text-align:left">Omega explicitly indexed</td>
<td style="text-align:left">a shortcut of the form <code>`âµğ’‹</code> (or <code>â¹ğ’‹</code>), to access the <code>ğ’‹</code><strong>th</strong> element of <code>âµ</code>, i.e. <code>âµâŠƒâ¨ ğ’‹+â•IO</code>. <em>See details below.</em></td>
</tr>
<tr>
<td style="text-align:left">`âµ, â¹</td>
<td style="text-align:left">Omega implicitly indexed</td>
<td style="text-align:left">a shortcut of the form <code>`âµ</code> (or <code>â¹</code>), to access the <strong>next</strong> element of <code>âµ</code>. <em>See details below.</em></td>
</tr>
</tbody>
</table>
<hr>
<div style="margin-left: 20px;">
<table>
<thead>
<tr>
<th style="text-align:left">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Â¹ The syntax for the Date-Time specifications (left arg) can be found in the Dyalog documentation under <b>1200âŒ¶</b>. For the curious, hereâ€™s the code actually used by the Date-Time shortcut: <br>Â Â Â Â <code>{âºâ†'YYYY-MM-DD hh:mm:ss' â‹„ âˆŠâ£(1=â‰¡âµ)âŠ¢ âº(1200âŒ¶)âŠ¢ 1â•DT âŠ†âµ}</code>.</td>
</tr>
</tbody>
</table>
</div>
<hr>
<h3>Omega Shortcut Expressions: Details</h3>
<ol>
<li>
<p><strong>â¹</strong> is a synonym for <strong>`âµ</strong>. It is Unicode character <code>â•UCS 9081</code>. Either expression is valid only in <strong>Code</strong> fields and outside <strong>Quoted strings</strong>.</p>
</li>
<li>
<p><strong>`âµ</strong> or <strong>â¹</strong> uses an â€œ<em>omega index counter</em>â€ (<strong>OIC</strong>) which weâ€™ll represent as <strong>Î©</strong>, common across all <strong>Code</strong> fields, which is initially set to zero, <code>Î©â†0</code>. (Î© is just used for explication; donâ€™t actually use this symbol)</p>
</li>
<li>
<p>All omega shortcut expressions in the <strong>f-string</strong> are evaluated left to right and are â•IO-independent.</p>
</li>
<li>
<p><strong>`âµğ’‹</strong> or <strong>â¹ğ’‹</strong> sets the <em>OIC</em> to ğ’‹, <code>Î©â†ğ’‹</code>, and returns the expression <code>âµâŠƒâ¨Î©+â•IO</code>. Here <strong>ğ’‹</strong> must be a <em>non-negative integer</em> with at least 1 digit.</p>
</li>
<li>
<p>Bare <strong>`âµ</strong> or <strong>â¹</strong> (i.e. with no digits appended) increments the <em>OIC</em>, <code>Î©+â†1</code>, <em>before</em> using it as the index in the expression <code>âµâŠƒâ¨Î©+â•IO</code>.</p>
</li>
<li>
<p>You can only access the 0-th element of <strong>âµ</strong> via an <em>explicitly indexed omega</em> <code>`âµ0</code> or <code>â¹0</code>. The <em>implicitly indexed</em> omega always increments its index <em>before</em> use, so the first index that can be used <strong><em>implicitly</em></strong> is <strong>1</strong>, i.e. <code>`âµ1</code> or <code>â¹1</code>.</p>
</li>
<li>
<p>If an element of the dfnâ€™s right argument <strong>âµ</strong> is accessed at runtime via any means, shortcut or traditional, that element <strong><em>must</em></strong> exist.</p>
</li>
</ol>

</body>
</html>